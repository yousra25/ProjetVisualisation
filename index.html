Popular / About yousra25’s Block a44a4c3acc918c13fd6e16a31b85ed5d
Updated January 11, 2017
ProjetV0

Open
forked from mbostock's block: Nested Treemap

index.html#

<html>
<head>
<meta charset="utf-8">

<style>

  
 .toolTip {
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
        position: absolute;
        display: none;
        width: auto;
        height: auto;
        background: none repeat scroll 0 0 white;
        border: 0 none;
        border-radius: 8px 8px 8px 8px;
        box-shadow: -3px 3px 15px #888888;
        color: black;
        font: 12px sans-serif;
        padding: 5px;
        text-align: center;
    }
  
  
  
.node circle {
  fill: #999;
}
.node text {
  font: 10px sans-serif;
}
.node--internal circle {
  fill: #555;
}
.node--internal text {
  text-shadow: 0 1px 0 #fff, 0 -1px 0 #fff, 1px 0 0 #fff, -1px 0 0 #fff;
}
  
.link {
  fill: none;
  stroke: #555;
  stroke-opacity: 0.4;
  stroke-width: 1.5px;
} 
text {
  font: 10px sans-serif;
}
g .youyou {
  font: 15px sans-serif;
}
.lien {
  font: 13px sans-serif;
}
.legende {
  font: 13px sans-serif;
  color:#C0C0C0;
}
  .titre {
  font: 60px sans-serif;
}
tspan:last-child {
  font-size: 9px;
  fill-opacity: 0.8;
}
.node rect {
  shape-rendering: crispEdges;
}
.node--hover rect {
  stroke: #000;
}
.link {
  fill: none;
  stroke: #555;
  stroke-opacity: 0.4;
  stroke-width: 1.5px;
}
</style>
</head>
<body>
<svg width="965" height="750"></svg>
<script src="//d3js.org/d3.v4.0.0-alpha.35.min.js"></script>

<script src="https://d3js.org/d3.v4.min.js"></script>
<script>

  
   var div = d3.select("body").append("div").attr("class", "toolTip");
  
  var svg = d3.select("svg"),
    width = +svg.attr("width")/2,
    height = +svg.attr("height")/2;
 

 g2 = svg.append("g").attr("transform", "translate(" + (0) + "," + (100) + ")"); 
  
  svg.call(d3.zoom()
    .scaleExtent([100, 100])
    .on("zoom", zoomed));

function zoomed() {
  g1.attr("transform", d3.event.transform);
}

var container1 = svg.append('g').attr("id","sommaire");  
var svg1= d3.select("body").append("svg").attr("width", 960).attr("height", 2000);
  g1 = svg1.append("g").attr("transform", "translate(" + (width / 2 +800) + "," + (800) + ")");
    var texte = svg.append("text")
    		.text("Fichiers d'un utilisateur (Windows)")
    		.attr('x',10)
    		.attr('y',50)
        .attr("class","titre")
    		.attr("font-size", "50px")
  			.attr("font-family","Times New Roman")      
  			.attr("fill", "#2F4F4F");
  var texte = container1.append("text")
    		.text("Espace total occupé par chaque types de fichier")
    		.attr('x',610)
    		.attr('y',150)
        .attr("class","youyou")
    		.attr("font-size", "20px")
  			.attr("font-family","Times New Roman")      
  			.attr("fill", "#2F4F4F");
  
var stratify1 = d3.stratify()
    .parentId(function(d) { return d.id.substring(0, d.id.lastIndexOf(".")); });
var tree = d3.tree()
    .size([360, 500])
    .separation(function(a, b) { return (a.parent == b.parent ? 1 : 2) / a.depth; });
 

//********************************************************************* 
d3.csv("flare.csv", function(error, data) {
  
  if (error) throw error;


  var root = tree(stratify1(data));
  var link = svg1.selectAll(".link")
    .data(root.descendants().slice(1))
    .enter().append("path")
      .attr("class", "link")
      .attr("d", function(d) {
        return "M" + project(d.x, d.y)
            + "C" + project(d.x, (d.y + d.parent.y) / 2)
            + " " + project(d.parent.x, (d.y + d.parent.y) / 2)
            + " " + project(d.parent.x, d.parent.y);
      });
  var node = svg1.selectAll(".node")
    .data(root.descendants())
    .enter().append("g")
      .attr("class", function(d) { return "node" + (d.children ? " node--internal" : " node--leaf"); })
      .attr("transform", function(d) { return "translate(" + project(d.x, d.y) + ")"; });
  node.append("circle")
      .attr("r", 2.5);
  node.append("text")
      .attr("dy", ".31em")
      .attr("x", function(d) { return d.x < 180 === !d.children ? 6 : -6; })
      .style("text-anchor", function(d) { return d.x < 180 === !d.children ? "start" : "end"; })
      .attr("transform", function(d) { return "rotate(" + (d.x < 180 ? d.x - 90 : d.x + 90) + ")"; })
      .text(function(d) { return d.id.substring(d.id.lastIndexOf(".") + 1); });
});
  
function project(x, y) {
  var angle = (x - 90) / 180 * Math.PI, radius = y;
  return [radius * Math.cos(angle), radius * Math.sin(angle)];
}  
  
  
  
var format = d3.format(",d");
var color = d3.scaleMagma()
    .domain([-4, 4]);
var stratify = d3.stratify()
    .parentId(function(d) { return d.id.substring(0, d.id.lastIndexOf(".")); });
var treemap = d3.treemap()
    .size([600, height+220])
    .paddingOuter(10)
    .paddingTop(5)
    .paddingInner(1)
    .round(true);
d3.csv("dossiers", function(error, data) {
  if (error) throw error;
  var root = stratify(data)
      .sum(function(d) { return d.value; })
      .sort(function(a, b) { return b.height - a.height || b.value - a.value; });
  treemap(root);
  var cell = g2
    .selectAll(".node")
    .data(root.descendants())
    .enter().append("g")
      .attr("transform", function(d) { return "translate(" + d.x0 + "," + d.y0 + ")"; })
      .attr("class", "node")
      .each(function(d) { d.node = this; })
  
      .on("mouseover", hovered(true))
      .on("mouseout", hovered(false));
  cell.append("rect")
      .attr("id", function(d) { return "rect-" + d.id; })
      .attr("width", function(d) { return d.x1 - d.x0; })
      .attr("height", function(d) { return d.y1 - d.y0; })
      .style("fill", function(d) { return color2(d); });
  cell.append("clipPath")
      .attr("id", function(d) { return "clip-" + d.id; })
    .append("use")
      .attr("xlink:href", function(d) { return "#rect-" + d.id + ""; });
  var label = cell.append("text")
      .attr("clip-path", function(d) { return "url(#clip-" + d.id + ")"; });
  cell.append("title")
      .text(function(d) { return d.id + "\n" + format(d.value); });
});
   //*********************************************************************
 var  result = [{clé:"pdf)", valeur:0}, {clé:"txt)", valeur:0}, {clé:"png)", valeur: 0},{clé:"mp4)", valeur:0}, {clé:"jar)", valeur:0}, {clé:"zip)", valeur: 0},{clé:"csv)", valeur:0}, {clé:"json)", valeur:0}, {clé:"pptx)", valeur: 0},{clé:"pdf)", valeur:0}, {clé:"docx", valeur:0}];

  
  
d3.csv("dossiers", function(error, data) {
  
  if (error) throw error;
 
  
 var types = ["pdf)", "txt)","png)","jpg)", "mp4)","jar)","zip)","csv)","json","pptx","docx)"];
toString =JSON.stringify(types);
  for (var i=0; i<data.length; i++){

    
   if (!(typeof data[i].value === "undefined")){
     type=data[i].id.split("(")[1]; 

      switch (type) { 
      case "pdf)": 
         // console.log(data[i].value);
        result[0].valeur+=+data[i].value;
        break;
      case "txt)":
                result[1].valeur+=+data[i].value;
        break;
      case "png)":
                result[2].valeur+=+data[i].value;
        break;
      case "jpg)":
                result[3].valeur+=+data[i].value;
        break;
      case "mp4)":
          result[4].valeur+=+data[i].value;
        break;
       case "jar)":
          result[5].valeur+=+data[i].value;
        break;
         case "zip)":
          result[6].valeur+=+data[i].value;
        break;
                case "csv)":
          result[7].valeur+=+data[i].value;
        break;
                case "json)":
          result[8].valeur+=+data[i].value;
        break;
                case "pptx)":
          result[9].valeur+=+data[i].value;
        break;
                case "docx)":
          result[10].valeur+=+data[i].value;
        break;

      default:
   
    }
     
   }
  }
  //"pdf)", "txt)","png)","jpg)", "mp4)","jar)","zip)","csv)","json","pptx","docx)"
  data = [{cat:"pdf)",value:result[0].valeur},{cat:"txt)",value:result[1].valeur},
         {cat:"png)",value:result[2].valeur},{cat:"jpg)",value:result[3].valeur},
         {cat:"mp4)",value:result[4].valeur},{cat:"jar)",value:result[5].valeur},
         {cat:"zip)",value:result[6].valeur},{cat:"csv)",value:result[7].valeur},
         {cat:"json)",value:result[8].valeur},{cat:"pptx)",value:result[9].valeur},
         {cat:"docx)",value:result[10].valeur}];
  
  var bars=container1.selectAll("rect")
	.data(data)
	.enter()
		.append("rect")
			.attr("width", function(d){ console.log(d.value);  return d.value/1000000;})
			.attr("height", 40)
		  .attr("x", 700)  
			.attr("y", function(i,j){return j*50 +200;})
			.attr("fill", function(d){console.log(d.cat); return colorBar(d.cat); });
 
  container1.append("text").text("pdf").attr('x',660).attr('y',230).attr("class","legende");
container1.append("text").text("txt").attr('x',660).attr('y',280).attr("class","legende");
container1.append("text").text("png").attr('x',660).attr('y',330).attr("class","legende");
container1.append("text").text("jpg").attr('x',660).attr('y',380).attr("class","legende");
  container1.append("text").text("mp4").attr('x',660).attr('y',430).attr("class","legende");
container1.append("text").text("jar").attr('x',660).attr('y',480).attr("class","legende");
container1.append("text").text("zip").attr('x',660).attr('y',530).attr("class","legende");
container1.append("text").text("csv").attr('x',660).attr('y',580).attr("class","legende");
container1.append("text").text("json").attr('x',660).attr('y',630).attr("class","legende");
container1.append("text").text("pptx)").attr('x',660).attr('y',680).attr("class","legende");         container1.append("text").text("docx").attr('x',660).attr('y',730).attr("class","legende");
container1.append("text").text("Radial Tidy Tree (Mike Bostock)").attr('x',10).attr('y',730).attr("class","legende");
          
});

 

 
  
 //*********************************************************************  


  
  function hovered(hover) {
  return function(d) {
    //div.style("display", "none");
    d3.selectAll(d.ancestors().map(function(d) { return d.node; }))
        .classed("node--hover", hover)
      .select("rect")
        .attr("width", function(d) { return d.x1 - d.x0 - hover; })
        .attr("height", function(d) { return d.y1 - d.y0 - hover; });
    var dossiers=d.id.split("."); 
    var dossier=" Le lien relatif : "
    for (var i=0; i<dossiers.length; i++){
      dossier+="/"+dossiers[i];
    }
     d3.select("#myText").remove();
    container1.append("text")
    		.text(dossier)
    		.attr('x',10)
    		.attr('y',85)
        .attr("class","lien")
    		.attr("id","mytext")
    		.attr("font-size", "20px")
  			.attr("font-family","Times New Roman")      
  			.attr("fill", "#2F4F4F");  	
      /* div.style("left", d3.event.pageX+10+"px");
                div.style("top", d3.event.pageY-25+"px");
                div.style("display", "inline-block");
                div.html((d.id)+"<br>"+(d.value));*/
  };
     
   
          
}
  
function  colorBar(d) {
  //console.log(d.id); 
  if (d=="pdf)")
    return "#FFFACD"; 
  else if (d=="txt)")
  	return "#D19275";//"#DEB887"; 
  else if (d=="png)")
  	return "#ffd014";
  else if (d=="jpg)")
  	return "#8FBC8F"; 
  else if (d=="mp4)")
  	return "#e5c319";
  else if (d=="jar)")
  	return "#f1d688";
  else if (d=="zip)")
  	return "#DCDCDC";
    else if (d=="csv)")
  	return "#FFD700";
  else if (d=="json)" || d.id=="geojson)")
  	return "#f1d688";
  else if (d=="pptx)")
  	return "#FFE4C4";
  else if (d=="pptm)")
  	return "#FFE4C4";
  else if (d=="docx)")
  	return "#CD5C5C";
  
}   
function color2(d) {
  //console.log(d.id); 
  if (d.id.split("(")[1]=="pdf)")
    return "#FFFACD"; 
  else if (d.id.split("(")[1]=="txt)")
  	return "#D19275";//"#DEB887"; 
  else if (d.id.split("(")[1]=="png)")
  	return "#ffd014";
  else if (d.id.split("(")[1]=="jpg)")
  	return "#8FBC8F"; 
  else if (d.id.split("(")[1]=="mp4)")
  	return "#e5c319";
  else if (d.id.split("(")[1]=="jar)")
  	return "#f1d688";
  else if (d.id.split("(")[1]=="zip)")
  	return "#DCDCDC";
    else if (d.id.split("(")[1]=="csv)")
  	return "#FFD700";
  else if (d.id.split("(")[1]=="json)" || d.id.split("(")[1]=="geojson)")
  	return "#f1d688";
  else if (d.id.split("(")[1]=="pptx)")
  	return "#FFE4C4";
  else if (d.id.split("(")[1]=="pptm)")
  	return "#FFE4C4";
  else if (d.id.split("(")[1]=="docx)")
  	return "#CD5C5C";
  else return color(d.depth);
  
}   
  
</script>
</body>
</html>
flare.csv#

id,value
flare,
flare.analytics,
flare.analytics.cluster,
flare.analytics.cluster.AgglomerativeCluster,3938
flare.analytics.cluster.CommunityStructure,3812
flare.analytics.cluster.HierarchicalCluster,6714
flare.analytics.cluster.MergeEdge,743
flare.analytics.graph,
flare.analytics.graph.BetweennessCentrality,3534
flare.analytics.graph.LinkDistance,5731
flare.analytics.graph.MaxFlowMinCut,7840
flare.analytics.graph.ShortestPaths,5914
flare.analytics.graph.SpanningTree,3416
flare.analytics.optimization,
flare.analytics.optimization.AspectRatioBanker,7074
flare.animate,
flare.animate.Easing,17010
flare.animate.FunctionSequence,5842
flare.animate.interpolate,
flare.animate.interpolate.ArrayInterpolator,1983
flare.animate.interpolate.ColorInterpolator,2047
flare.animate.interpolate.DateInterpolator,1375
flare.animate.interpolate.Interpolator,8746
flare.animate.interpolate.MatrixInterpolator,2202
flare.animate.interpolate.NumberInterpolator,1382
flare.animate.interpolate.ObjectInterpolator,1629
flare.animate.interpolate.PointInterpolator,1675
flare.animate.interpolate.RectangleInterpolator,2042
flare.animate.ISchedulable,1041
flare.animate.Parallel,5176
flare.animate.Pause,449
flare.animate.Scheduler,5593
flare.animate.Sequence,5534
flare.animate.Transition,9201
flare.animate.Transitioner,19975
flare.animate.TransitionEvent,1116
flare.animate.Tween,6006
flare.data,
flare.data.converters,
flare.data.converters.Converters,721
flare.data.converters.DelimitedTextConverter,4294
flare.data.converters.GraphMLConverter,9800
flare.data.converters.IDataConverter,1314
flare.data.converters.JSONConverter,2220
flare.data.DataField,1759
flare.data.DataSchema,2165
flare.data.DataSet,586
flare.data.DataSource,3331
flare.data.DataTable,772
flare.data.DataUtil,3322
flare.display,
flare.display.DirtySprite,8833
flare.display.LineSprite,1732
flare.display.RectSprite,3623
flare.display.TextSprite,10066
flare.flex,
flare.flex.FlareVis,4116
flare.physics,
flare.physics.DragForce,1082
flare.physics.GravityForce,1336
flare.physics.IForce,319
flare.physics.NBodyForce,10498
flare.physics.Particle,2822
flare.physics.Simulation,9983
flare.physics.Spring,2213
flare.physics.SpringForce,1681
flare.query,
flare.query.AggregateExpression,1616
flare.query.And,1027
flare.query.Arithmetic,3891
flare.query.Average,891
flare.query.BinaryExpression,2893
flare.query.Comparison,5103
flare.query.CompositeExpression,3677
flare.query.Count,781
flare.query.DateUtil,4141
flare.query.Distinct,933
flare.query.Expression,5130
flare.query.ExpressionIterator,3617
flare.query.Fn,3240
flare.query.If,2732
flare.query.IsA,2039
flare.query.Literal,1214
flare.query.Match,3748
flare.query.Maximum,843
flare.query.methods,
flare.query.methods.add,593
flare.query.methods.and,330
flare.query.methods.average,287
flare.query.methods.count,277
flare.query.methods.distinct,292
flare.query.methods.div,595
flare.query.methods.eq,594
flare.query.methods.fn,460
flare.query.methods.gt,603
flare.query.methods.gte,625
flare.query.methods.iff,748
flare.query.methods.isa,461
flare.query.methods.lt,597
flare.query.methods.lte,619
flare.query.methods.max,283
flare.query.methods.min,283
flare.query.methods.mod,591
flare.query.methods.mul,603
flare.query.methods.neq,599
flare.query.methods.not,386
flare.query.methods.or,323
flare.query.methods.orderby,307
flare.query.methods.range,772
flare.query.methods.select,296
flare.query.methods.stddev,363
flare.query.methods.sub,600
flare.query.methods.sum,280
flare.query.methods.update,307
flare.query.methods.variance,335
flare.query.methods.where,299
flare.query.methods.xor,354
flare.query.methods._,264
flare.query.Minimum,843
flare.query.Not,1554
flare.query.Or,970
flare.query.Query,13896
flare.query.Range,1594
flare.query.StringUtil,4130
flare.query.Sum,791
flare.query.Variable,1124
flare.query.Variance,1876
flare.query.Xor,1101
flare.scale,
flare.scale.IScaleMap,2105
flare.scale.LinearScale,1316
flare.scale.LogScale,3151
flare.scale.OrdinalScale,3770
flare.scale.QuantileScale,2435
flare.scale.QuantitativeScale,4839
flare.scale.RootScale,1756
flare.scale.Scale,4268
flare.scale.ScaleType,1821
flare.scale.TimeScale,5833
flare.util,
flare.util.Arrays,8258
flare.util.Colors,10001
flare.util.Dates,8217
flare.util.Displays,12555
flare.util.Filter,2324
flare.util.Geometry,10993
flare.util.heap,
flare.util.heap.FibonacciHeap,9354
flare.util.heap.HeapNode,1233
flare.util.IEvaluable,335
flare.util.IPredicate,383
flare.util.IValueProxy,874
flare.util.math,
flare.util.math.DenseMatrix,3165
flare.util.math.IMatrix,2815
flare.util.math.SparseMatrix,3366
flare.util.Maths,17705
flare.util.Orientation,1486
flare.util.palette,
flare.util.palette.ColorPalette,6367
flare.util.palette.Palette,1229
flare.util.palette.ShapePalette,2059
flare.util.palette.SizePalette,2291
flare.util.Property,5559
flare.util.Shapes,19118
flare.util.Sort,6887
flare.util.Stats,6557
flare.util.Strings,22026
flare.vis,
flare.vis.axis,
flare.vis.axis.Axes,1302
flare.vis.axis.Axis,24593
flare.vis.axis.AxisGridLine,652
flare.vis.axis.AxisLabel,636
flare.vis.axis.CartesianAxes,6703
flare.vis.controls,
flare.vis.controls.AnchorControl,2138
flare.vis.controls.ClickControl,3824
flare.vis.controls.Control,1353
flare.vis.controls.ControlList,4665
flare.vis.controls.DragControl,2649
flare.vis.controls.ExpandControl,2832
flare.vis.controls.HoverControl,4896
flare.vis.controls.IControl,763
flare.vis.controls.PanZoomControl,5222
flare.vis.controls.SelectionControl,7862
flare.vis.controls.TooltipControl,8435
flare.vis.data,
flare.vis.data.Data,20544
flare.vis.data.DataList,19788
flare.vis.data.DataSprite,10349
flare.vis.data.EdgeSprite,3301
flare.vis.data.NodeSprite,19382
flare.vis.data.render,
flare.vis.data.render.ArrowType,698
flare.vis.data.render.EdgeRenderer,5569
flare.vis.data.render.IRenderer,353
flare.vis.data.render.ShapeRenderer,2247
flare.vis.data.ScaleBinding,11275
flare.vis.data.Tree,7147
flare.vis.data.TreeBuilder,9930
flare.vis.events,
flare.vis.events.DataEvent,2313
flare.vis.events.SelectionEvent,1880
flare.vis.events.TooltipEvent,1701
flare.vis.events.VisualizationEvent,1117
flare.vis.legend,
flare.vis.legend.Legend,20859
flare.vis.legend.LegendItem,4614
flare.vis.legend.LegendRange,10530
flare.vis.operator,
flare.vis.operator.distortion,
flare.vis.operator.distortion.BifocalDistortion,4461
flare.vis.operator.distortion.Distortion,6314
flare.vis.operator.distortion.FisheyeDistortion,3444
flare.vis.operator.encoder,
flare.vis.operator.encoder.ColorEncoder,3179
flare.vis.operator.encoder.Encoder,4060
flare.vis.operator.encoder.PropertyEncoder,4138
flare.vis.operator.encoder.ShapeEncoder,1690
flare.vis.operator.encoder.SizeEncoder,1830
flare.vis.operator.filter,
flare.vis.operator.filter.FisheyeTreeFilter,5219
flare.vis.operator.filter.GraphDistanceFilter,3165
flare.vis.operator.filter.VisibilityFilter,3509
flare.vis.operator.IOperator,1286
flare.vis.operator.label,
flare.vis.operator.label.Labeler,9956
flare.vis.operator.label.RadialLabeler,3899
flare.vis.operator.label.StackedAreaLabeler,3202
flare.vis.operator.layout,
flare.vis.operator.layout.AxisLayout,6725
flare.vis.operator.layout.BundledEdgeRouter,3727
flare.vis.operator.layout.CircleLayout,9317
flare.vis.operator.layout.CirclePackingLayout,12003
flare.vis.operator.layout.DendrogramLayout,4853
flare.vis.operator.layout.ForceDirectedLayout,8411
flare.vis.operator.layout.IcicleTreeLayout,4864
flare.vis.operator.layout.IndentedTreeLayout,3174
flare.vis.operator.layout.Layout,7881
flare.vis.operator.layout.NodeLinkTreeLayout,12870
flare.vis.operator.layout.PieLayout,2728
flare.vis.operator.layout.RadialTreeLayout,12348
flare.vis.operator.layout.RandomLayout,870
flare.vis.operator.layout.StackedAreaLayout,9121
flare.vis.operator.layout.TreeMapLayout,9191
flare.vis.operator.Operator,2490
flare.vis.operator.OperatorList,5248
flare.vis.operator.OperatorSequence,4190
flare.vis.operator.OperatorSwitch,2581
flare.vis.operator.SortOperator,2023
flare.vis.Visualization,16540
test#

id, value
nomDossier1.fichier1
nomDossier1.fichier2
nomDossier1.nomDossier2
nomDossier2.fichier21
nomDossier2.fichier22

test.csv#

id,value
nomDossier1,
nomDossier1.nomDossier2,
nomDossier1.nomDossier2.nomDossier3,
nomDossier1.nomDossier2.nomDossier3.nomFichier1(pdf),100
nomDossier1.nomDossier2.nomDossier3.nomFichier2(txt),400
nomDossier1.nomDossier2.nomDossier3.nomFichier3(JPG),500
nomDossier1.nomDossier2.nomDossier3.nomFichier4(JPEG),50
LICENSE#

Released under the GNU General Public License, version 3.
